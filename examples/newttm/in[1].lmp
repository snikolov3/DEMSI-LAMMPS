echo    both
#package gpu 1 

#------------- USER Variables ----------------   
variable        filename   string    a305_12_6_6
variable        heatflux   equal    20.0
variable        dump_freq  equal  100

# boltzmann constant in appropriate units   
variable        boltz_real     equal 0.0019872041
variable        boltz_metal    equal 8.617342e-5
variable        boltz          equal ${boltz_metal}

variable        lattice_const  equal 3.57772
variable        starttemp    equal 300

variable xmax equal 25 # size in the x-direction
variable xmin equal -25 # size in the x-direction
variable ymax equal 12.5 # size in the y-direction
variable ymin equal -12.5 # size in the x-direction
variable zmax equal 12.5 # size in the z-direction
variable zmin equal -12.5 # size in the x-direction
#----------------------------------------------
##########################################
units           metal
atom_style      full

boundary        p p p

#read_restart    config5
lattice         fcc ${lattice_const}
region sim_box block ${xmin} ${xmax} ${ymin} ${ymax} ${zmin} ${zmax} # units for region are lattice (default)
create_box 1 sim_box
region atom_box block ${xmin} ${xmax} ${ymin} ${ymax} ${zmin} ${zmax}
create_atoms 1 region atom_box

mass	        1 55.845
variable        mid_val        equal    xhi/2.0
variable        low_val        equal    ${mid_val}-4*${lattice_const}
variable        high_val       equal    ${mid_val}+4*${lattice_const}
variable        max_val        equal    ${high_val}+${low_val}

include pot_iron.mod

#pair_style      eam/alloy
#pair_coeff      * * FeNiCr_Bonny_2013_ptDef.eam.alloy Fe Cr Ni

set             atom * type 1
neighbor        2.0 bin
neigh_modify    every 5 delay 0 check yes

#variable        st equal ${starttemp}*1.5
#velocity        all create ${st} 87287 mom yes loop geom

#fix            thermostat all npt temp ${starttemp} ${starttemp} 10.0 iso 0.0 0.0 1000.0
#fix             thermostat all langevin ${starttemp} ${starttemp} 10 618341
fix             1 all nve
#velocity        all set NULL 1 NULL sum yes units box

######################################################################      
region          lhs block -${high_val} -${low_val} EDGE EDGE EDGE EDGE units box
region          rhs block  ${low_val} ${high_val} EDGE EDGE EDGE EDGE units box
group           lhs_group region lhs
group           rhs_group region rhs
fix             qin lhs_group heat 1 ${heatflux}
fix             qout rhs_group heat 1 -${heatflux}

###########################################################################   
#fix 1z          all langevin 1.0 1.1 100.0 48279 scale 1 1.5
#compute 	mytemp all temp/com
fix             melt all ttm 342785 1.2470e-5 0.087614 0.00536462 29.5917 47.5679 58.4613 12 6 6 temp_300_nx_12_ny_6_nz_6 ${dump_freq} ${filename}.Te
#fix_modify      melt temp mytemp
########################################################################### 

# output        
compute         pe all pe/atom
compute         ke all ke/atom
variable        temp atom c_ke/1.5/v_boltz

dump            1z1 all custom ${dump_freq} ${filename}.dumpovito id type mol x y z c_ke c_pe 

compute         temp_chunk all chunk/atom bin/1d x lower 2.0
fix             4 all ave/chunk 1 ${dump_freq} ${dump_freq} temp_chunk  v_temp &
                   file ${filename}.tmpProfile

# run    
timestep        0.001
thermo_style 	custom time step temp lx ly lz press pxx pyy pzz etotal epair enthalpy vol density f_melt[1] f_melt[2]
thermo          10
run             10000

#write_data      ${filename}_${starttemp}.lammps 
write_restart     ${filename}_${starttemp}.restart
write_restart   config${filename}
